---
const fetchData = async () => {
  const response = await fetch(
    "https://v1.nocodeapi.com/roshambo/instagram/IwFRjheBjJPUkvhF?limit=6"
  );
  if (!response.ok) {
    throw new Error("Network response was not ok");
  }
  return response.json();
};

let result: any = null;

try {
  result = await fetchData();
} catch (error) {
  console.error("Failed to fetch Instagram data:", error);
}
---

<section>
  <h2 class="font-semibold uppercase text-2xl mb-6 text-white">
    FOLLOW <a
      href="https://www.instagram.com/rasjahknow/"
      class="hover:underline"
      target="_blank"
      rel="noopener noreferrer">@RASJAHKNOW</a
    >
  </h2>
  <div class="grid grid-cols-1 sm:grid-cols-4 md:grid-cols-3 gap-1">
    {
      result?.data?.length === 0 &&
        [...Array(6)].map((_, i: number) => (
          <div>
            <a href="#" title="Blank Href">
              <div
                class="relative w-full md:h-60 sm:h-48 h-80"
                style={{
                  animation: "shadingAnimation 2s infinite",
                  background: "black",
                  opacity: 0.5,
                }}
              >
                <div class="bg-gray-500 absolute w-full h-full left-0 bottom-0 top-0 right-0" />
              </div>
            </a>
          </div>
        ))
    }

    {
      result && result.data
        ? result.data.map((item: any, i: number) =>
            item.media_type === "IMAGE" ? (
              <a
                href={item.permalink}
                data-media-type="image"
                target="_blank"
                rel="noopener noreferrer"
              >
                <div class="relative w-full md:h-60 sm:h-48 h-80 ">
                  <div class="bg-black bg-opacity-30 absolute w-full h-full left-0 bottom-0 top-0 right-0 hover:bg-gray-900 hover:bg-opacity-50" />
                  <img
                    class="object-cover w-full h-full"
                    src={item.media_url}
                    alt={item.caption}
                    loading="lazy"
                  />
                </div>
              </a>
            ) : item.media_type === "VIDEO" ? (
              <a
                href={item.permalink}
                data-media-type="video"
                target="_blank"
                rel="noopener noreferrer"
              >
                <div class="relative w-full md:h-60 sm:h-48 h-80 ">
                  <div class="absolute left-0 bottom-0 top-0 right-0 z-30 flex justify-center items-center flex-col hover:bg-gray-900 hover:bg-opacity-50">
                    <span class="sr-only">Watch the video</span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-20 w-20 text-white"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path d="M10 8.64v6.72L15.27 12L10 8.64z" />
                      <path d="M21 12c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9 9-4.03 9-9zm-18 0c0-4.97 4.03-9 9-9s9 4.03 9 9-4.03 9-9 9-9-4.03-9-9z" />
                    </svg>
                  </div>
                  <div class="bg-black bg-opacity-30 absolute w-full h-full left-0 bottom-0 top-0 right-0 z-10" />
                  <img
                    class="object-cover w-full h-full"
                    src={item.thumbnail_url}
                    alt={item.caption}
                    loading="lazy"
                  />
                </div>
              </a>
            ) : item.media_type === "CAROUSEL_ALBUM" ? (
              <a
                href={item.permalink}
                data-media-type="carousel_item"
                target="_blank"
                rel="noopener noreferrer"
              >
                <div class="relative w-full md:h-60 sm:h-48 h-80">
                  <div class="bg-black bg-opacity-30 absolute w-full h-full left-0 bottom-0 top-0 right-0 hover:bg-gray-900 hover:bg-opacity-50" />
                  <img
                    class="object-cover w-full h-full"
                    src={item.media_url}
                    alt={item.caption}
                    loading="lazy"
                  />
                </div>
              </a>
            ) : null
          )
        : null
    }
  </div>
</section>
