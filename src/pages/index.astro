---
import Layout from "../layouts/Layout.astro";
import Carousel from "../components/Carousel.astro";
import Members from "../components/Members.astro";
import Albums from "../components/Albums.astro";
import Button from "../components/Button.astro";

import { format } from 'date-fns' 
const artist = "Ras Jahknow Band";
const apiUrl = `https://rest.bandsintown.com/artists/${artist}/events?app_id=squarespace-todd-wright-gxya&date=all`;
const response = await fetch(apiUrl);
const data = await response.json();
---

<Layout title="Ras Jahknow">
  <main>
    <!-- <h1>Welcome to <span class="text-gradient">Astro</span></h1> -->
    <Carousel />
    <section class="w-8/12 mx-auto my-10">
      <Members />
    </section>
    <Albums />
    <section class="bg-black bg-opacity-80 mx-auto pb-8 pt-4">
      <div class="w-8/12 mx-auto my-5">
		<div class="flex justify-between items-center">
			<h3 class="text-white text-2xl font-medium py-10 uppercase">Upcoming Shows</h3>
			<Button href="/events">View Events</Button>
		</div>
        <div
          class="bg-gray-500 bg-opacity-70 py-4 px-10 mb-2 flex justify-between text-white uppercase font-medium"
        >
          <div class="w-3/12">Date</div>
          <div class="w-3/12">Venue</div>
          <div class="w-3/12">Location</div>
          <div class="w-3/12 text-right">Tickets</div>
        </div>
        {
          data.slice(0).reverse().map((event: any) => {
            return (
              <div class="bg-gray-600 bg-opacity-70 p-8 mb-2 flex justify-between items-center text-white">
                <div class="w-3/12">{format(new Date(event.datetime), 'dd/MM/yyyy')}</div>
                <div class="w-3/12">{event.venue.name}</div>
                <div class="w-3/12">
                  <div class="city">{event.venue.city}</div>
                  <div class="region">{event.venue.region}</div>
                  <div class="country">{event.venue.country}</div>
                </div>

                <div class="w-3/12 text-right">
                  <a
                    href={event.url}
                    rel="noreferrer"
                    target="_blank"
                    title={event.title}
					class="cursor-pointer appearance-none py-2 my-4 px-4 bg-transparent border-2 uppercase text-white font-semibold shadow-md hover:bg-red-700 hover:border-transparent focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-75"
                  >
                    Tickets
                  </a>
                </div>
              </div>
            );
          })
        }
      </div>
    </section>
  </main>
</Layout>
